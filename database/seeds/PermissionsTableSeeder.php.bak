<?php

use Illuminate\Database\Seeder;
use Iome\Permission;
use Iome\Role;

class PermissionsTableSeeder extends Seeder
{

	public function run()
	{
		DB::table( 'permissions' )->truncate();

		$permissions = [
			[
				'name'         => 'manage_language',
				'display_name' => 'Manage languages',
				'is_admin'     => 1
			],
			[
				'name'         => 'manage_users',
				'display_name' => 'Manage users',
				'is_admin'     => 1
			],
			[
				'name'         => 'manage_roles',
				'display_name' => 'Manage roles',
				'is_admin'     => 1
			],
		];

		DB::table( 'permissions' )->insert( $permissions );

		DB::table( 'permission_role' )->truncate();

		$role_id_admin = Role::where( 'name', '=', 'admin' )->first()->id;
		$permission_base = (int)DB::table( 'permissions' )->first()->id - 1;

		$permissions = [
			[
				'role_id'       => $role_id_admin,
				'permission_id' => $permission_base + 1
			],
			[
				'role_id'       => $role_id_admin,
				'permission_id' => $permission_base + 2
			],
			[
				'role_id'       => $role_id_admin,
				'permission_id' => $permission_base + 3
			],
			[
				'role_id'       => $role_id_admin,
				'permission_id' => $permission_base + 4
			],
			[
				'role_id'       => $role_id_admin,
				'permission_id' => $permission_base + 5
			],
			[
				'role_id'       => $role_id_admin,
				'permission_id' => $permission_base + 6
			],
			[
				'role_id'       => $role_id_admin,
				'permission_id' => $permission_base + 7
			],
			[
				'role_id'       => $role_id_admin,
				'permission_id' => $permission_base + 8
			],
			[
				'role_id'       => $role_id_admin,
				'permission_id' => $permission_base + 9
			],
		];

		DB::table( 'permission_role' )->insert( $permissions );
	}

}